(()=>{var t={n:o=>{var n=o&&o.__esModule?()=>o.default:()=>o;return t.d(n,{a:n}),n},d:(o,n)=>{for(var a in n)t.o(n,a)&&!t.o(o,a)&&Object.defineProperty(o,a,{enumerable:!0,get:n[a]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o),t.d(o,{extend:()=>C});const n=flarum.core.compat["common/app"];t.n(n)().initializers.add("ianm/twofactor",(function(){}));const a=flarum.core.compat["admin/app"];var e=t.n(a);const r=flarum.core.compat["common/extend"],s=flarum.core.compat["admin/components/UserListPage"];var i=t.n(s);const l=flarum.core.compat["common/helpers/icon"];var c=t.n(l);const u=flarum.core.compat["admin/components/EditGroupModal"];var p=t.n(u);const d=flarum.core.compat["common/components/Switch"];var f=t.n(d);const g=flarum.core.compat["common/utils/Stream"];var _=t.n(g);const h=flarum.core.compat["common/models/Group"];var b=t.n(h);function w(t,o){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},w(t,o)}function v(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,w(t,o)}const y=flarum.core.compat["admin/components/ExtensionPage"];var k=t.n(y);const N=flarum.core.compat["admin/components/UploadImageButton"];var F=t.n(N);const S=flarum.core.compat["common/Component"];var x=t.n(S);const q=flarum.core.compat["common/components/GroupBadge"];var P=t.n(q),O=function(t){function o(){return t.apply(this,arguments)||this}return v(o,t),o.prototype.view=function(){return m("div",{className:"PermissionsPage-groups"},e().store.all("groups").filter((function(t){return-1===[b().GUEST_ID,b().MEMBER_ID].indexOf(t.id())})).map((function(t){return m("button",{className:"Button Group",onclick:function(){return e().modal.show(p(),{group:t})}},m(P(),{group:t,className:"Group-icon",label:null}),m("span",{className:"Group-name"},t.namePlural()))})),m("button",{className:"Button Group Group--add",onclick:function(){return e().modal.show(p())}},c()("fas fa-plus",{className:"Group-icon"}),m("span",{className:"Group-name"},e().translator.trans("core.admin.permissions.new_group_button"))))},o}(x()),A=function(t){function o(){return t.apply(this,arguments)||this}return v(o,t),o.prototype.content=function(){return m("div",{className:"container"},m("div",{className:"TwoFactorSettingsPage"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("h3",null,e().translator.trans("ianm-twofactor.admin.settings.groups.title")),m("p",{className:"helpText"},e().translator.trans("ianm-twofactor.admin.settings.groups.help")),m(O,null)),this.buildSettingComponent({setting:"ianm-twofactor.admin.settings.forum_logo_qr",type:"boolean",label:e().translator.trans("ianm-twofactor.admin.settings.forum_logo_qr"),help:e().translator.trans("ianm-twofactor.admin.settings.forum_logo_qr_help")}),m("div",{className:"Form-group"},m("label",null,e().translator.trans("ianm-twofactor.admin.settings.logo_qr")),m("div",{className:"helpText"},e().translator.trans("ianm-twofactor.admin.settings.logo_qr_help")),m(F(),{name:"ianm_twofactor_logo"})),this.buildSettingComponent({setting:"ianm-twofactor.admin.settings.forum_logo_qr_width",type:"number",label:e().translator.trans("ianm-twofactor.admin.settings.forum_logo_qr_width"),help:e().translator.trans("ianm-twofactor.admin.settings.forum_logo_qr_width_help"),max:200}),m("h3",null,e().translator.trans("ianm-twofactor.admin.settings.tokens.heading")),m("p",{className:"helpText"},e().translator.trans("ianm-twofactor.admin.settings.tokens.help")),this.buildSettingComponent({setting:"ianm-twofactor.kill_inactive_tokens",type:"boolean",label:e().translator.trans("ianm-twofactor.admin.settings.tokens.kill_inactive_tokens"),help:e().translator.trans("ianm-twofactor.admin.settings.tokens.kill_inactive_tokens_help")}),this.buildSettingComponent({setting:"ianm-twofactor.kill_inactive_tokens_age_days",type:"number",min:1,label:e().translator.trans("ianm-twofactor.admin.settings.tokens.kill_inactive_tokens_age_days"),help:e().translator.trans("ianm-twofactor.admin.settings.tokens.kill_inactive_tokens_age_days_help")}),this.buildSettingComponent({setting:"ianm-twofactor.also_kill_developer_tokens",type:"boolean",label:e().translator.trans("ianm-twofactor.admin.settings.tokens.also_kill_developer_tokens"),help:e().translator.trans("ianm-twofactor.admin.settings.tokens.also_kill_developer_tokens_help")}),this.submitButton())))},o}(k());const G=flarum.core.compat["common/extenders"];var T=t.n(G);const M=flarum.core.compat["common/models/User"];var E=t.n(M);const j=[new(T().Model)(E()).attribute("twoFactorEnabled").attribute("canDisable2FA").attribute("mustEnable2FA").attribute("backupCodesRemaining"),new(T().Model)(b()).attribute("requires2FA")],C=[].concat(j);e().initializers.add("ianm/twofactor",(function(){e().extensionData.for("ianm-twofactor").registerPage(A).registerPermission({icon:"fas fa-shield-alt",label:e().translator.trans("ianm-twofactor.admin.permissions.see_two_factor_status_label"),permission:"ianm-twofactor.seeTwoFactorStatus"},"moderate",65).registerPermission({icon:"fas fa-shield-alt",label:e().translator.trans("ianm-twofactor.admin.permissions.manage_others_label"),permission:"ianm-twofactor.manageOthers"},"moderate",60),(0,r.extend)(i().prototype,"columns",(function(t){t.add("2fa",{name:"2FA",content:function(t){return t.twoFactorEnabled()?m("p",null,c()("fas fa-shield-alt")):m("p",null)}},82)})),(0,r.extend)(p().prototype,"oninit",(function(t){this.requires2FA=_()(this.group.requires2FA()||!1)})),(0,r.extend)(p().prototype,"fields",(function(t){var o=this.group.id()===b().ADMINISTRATOR_ID;t.add("2fa",m("div",{className:"Form-group"},o?m("p",null,e().translator.trans("ianm-twofactor.admin.edit_group.admin_2fa_help",{adminName:this.group.nameSingular()})):m(f(),{state:this.requires2FA(),onchange:this.requires2FA},e().translator.trans("ianm-twofactor.admin.edit_group.2fa_label")),!o&&m("p",{className:"helpText"},e().translator.trans("ianm-twofactor.admin.edit_group.2fa_help"))),10)})),(0,r.extend)(p().prototype,"submitData",(function(t){return t.requires2FA=this.requires2FA(),t}))}))})(),module.exports=o})();
//# sourceMappingURL=admin.js.map